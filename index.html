<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Minh Nhựt Audio - nghe nhạc và radio trực tuyến" />
  <title>Minh Nhựt Audio</title>
  <link rel="icon" href="https://raw.githubusercontent.com/nhut990/files/refs/heads/main/hinh/Logo_minhnhut.png">
  <style>
    @keyframes blink { 0%{opacity:1}50%{opacity:0}100%{opacity:1} }
    body{font-family:Arial, Helvetica, sans-serif; color:#222; margin:0; padding:20px 10px;}
    #clock{font-family:monospace; letter-spacing:2px; text-align:center; margin-bottom:10px;}
    .center { text-align:center; }

    .radio-box {
      width: 220px;
      margin: 15px auto;
      padding: 8px;
      text-align: center;
      background: linear-gradient(45deg, #ff8800, #ffcc00);
      border-radius: 10px;
      box-shadow: 0 0 8px rgba(0,0,0,0.15);
      position: relative;
    }
    .radio-title { font-weight:bold; color:red; margin-bottom:6px; font-size:14px; }
    .radio-btn {
      background:#d32f2f;color:#fff;border:none;padding:6px 12px;border-radius:6px;cursor:pointer;font-size:13px;
    }
    .radio-btn:hover{ background:#b71c1c; }

    .wave {
      display:flex;justify-content:center;align-items:flex-end;gap:3px;height:18px;margin-top:6px;
    }
    .wave span { display:block;width:3px;background:red;animation:waveAnim 1s infinite ease-in-out;border-radius:2px;opacity:0.6; }
    .wave span:nth-child(1){animation-delay:0s} .wave span:nth-child(2){animation-delay:0.2s}
    .wave span:nth-child(3){animation-delay:0.4s} .wave span:nth-child(4){animation-delay:0.6s}
    .wave span:nth-child(5){animation-delay:0.8s}
    @keyframes waveAnim { 0%,100%{height:4px}50%{height:14px} }
    .radio-box:not(.playing) .wave { opacity:0; transition:opacity .2s; }

    audio { width:90%; max-width:640px; margin:8px auto; display:block; }

    .logo-marquee { width:100%; height:140px; overflow:hidden; margin-top:20px; }
    .marquee-track { display:flex; align-items:center; width:200%; animation:scrollLeft 10s linear infinite; }
    .marquee-track img { width:50%; max-height:120px; object-fit:contain; }
    @keyframes scrollLeft { from{transform:translateX(0)} to{transform:translateX(-50%)} }

    footer {
      background: linear-gradient(135deg, #00c6ff, #0072ff);
      padding: 15px 0; text-align:center; color:white; font-size:14px; margin-top:18px;
    }

    @media (max-width:500px){
      .radio-box{ width:90% }
      .radio-btn{ font-size:12px; padding:5px 10px }
    }

    /* small helper for fallback messages */
    .hint { font-size:12px; color:#333; margin-top:6px; }

    /* CONTACT PANEL (replaced by Telegram form) */
    #contact-widget { width:100%; display:flex; justify-content:center; margin-top:12px; }
    .contact-form { width: 370px; background: #101820; border-radius: 24px; box-shadow: 0 2px 20px rgba(0,0,0,0.18); padding: 32px 24px; color: #fff; margin: 40px auto; }
    .contact-form h2 { font-size: 2rem; font-weight: bold; margin-bottom: 24px; }
    .contact-form input, .contact-form textarea { width: 100%; padding: 14px 18px; margin-bottom: 16px; border: 1px solid rgba(255,255,255,0.08); border-radius: 14px; background: transparent; color: #fff; font-size: 1rem; outline: none; }
    .contact-form textarea { min-height: 70px; resize: vertical; }
    .form-actions { display: flex; gap: 16px; justify-content: flex-start; }
    .send-btn { background: #16e0d3; color: #222; font-size: 1.1rem; padding: 12px 38px; border-radius: 14px; border: none; font-weight: bold; cursor: pointer; transition: background 0.2s; }
    .send-btn:hover { background: #12c3b2; }
    .reset-btn { background: #222; color: #fff; font-size: 1.1rem; padding: 12px 38px; border-radius: 14px; border: none; font-weight: bold; cursor: pointer; transition: background 0.2s; }
    .reset-btn:hover { background: #444; }
    .notify { margin-top: 18px; color: #16e0d3; font-weight: bold; transition: opacity 1s; opacity: 1; }

    @media (max-width:420px){
      .contact-form { width:96vw; padding:14px; border-radius:10px; }
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</head>
<body>
  <div id="device-info" class="center" style="margin-bottom:6px;"></div>
  <!-- role=status và aria-live giúp screen-reader cập nhật (clock) -->
  <div id="clock" class="center" role="status" aria-live="polite" style="font-size:18px; font-weight:bold; color:#111;"></div>

  <script>
    function detectDevice(){
      let ua = navigator.userAgent;
      let os="Không xác định", device="Không rõ thiết bị", version="";

      if(/iPhone|iPad|iPod/i.test(ua)){
        os="iOS"; device = /iPad/i.test(ua) ? "iPad" : "iPhone";
        let match = ua.match(/OS (\d+[_\.\d]*) like Mac OS X/);
        if(match) version = " " + match[1].replace(/_/g,'.');
      } else if(/Android/i.test(ua)){
        os="Android"; device="Thiết bị Android";
        let match = ua.match(/Android\s([\d\.]+)/);
        if(match) version = " " + match[1];
      } else if(/Windows NT/i.test(ua)){
        os="Windows"; device="Máy tính";
        let match = ua.match(/Windows NT ([\d\.]+)/);
        if(match){
          const map={"10.0":"10","6.3":"8.1","6.2":"8","6.1":"7"};
          version = " " + (map[match[1]] || match[1]);
        }
      } else if(/Mac OS X/i.test(ua)){
        os="macOS"; device="Mac";
        let match = ua.match(/Mac OS X (\d+[_\.\d]*)/);
        if(match) version = " " + match[1].replace(/_/g,'.');
      }

      document.getElementById('device-info').innerHTML = `<b>${device}</b> - <b>${os}${version}</b>`;
    }

    function updateClock(){
      const now=new Date();
      const h=String(now.getHours()).padStart(2,'0');
      const m=String(now.getMinutes()).padStart(2,'0');
      const s=String(now.getSeconds()).padStart(2,'0');
      document.getElementById('clock').innerHTML = `<span style="color:#00cc66">${h}:${m}</span> <span style="color:red">${s}</span>`;
    }

    detectDevice();
    setInterval(updateClock,1000);
    updateClock();
  </script>

  <!-- ======= DANH SÁCH NHẠC ======= -->
  <div class="center" style="margin-top:10px;">
    <div style="font-size:16px;font-weight:700;color:#333;margin-bottom:8px;">Nhạc Thiền Tĩnh Tâm An Lạc</div>
    <audio controls preload="auto" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/nhac%20thien%20tinh%20tam.mp3" type="audio/mpeg">
      Trình duyệt của bạn không hỗ trợ thẻ audio.
    </audio>
  </div>

  <div class="center" style="margin-top:10px;">
    <div style="font-weight:700;margin-bottom:6px;">The Moment - Kenny G</div>
    <audio controls preload="none" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/Kenny%20G%20-%20The%20Moment.mp3" type="audio/mpeg">
    </audio>
  </div>

  <div class="center" style="margin-top:10px;">
    <div style="font-weight:700;margin-bottom:6px;">Toccata - Paul Mauriat</div>
    <audio controls preload="none" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/Toccata%20-%20Paul%20Mauriat%20-%20YouTube.mp3" type="audio/mpeg">
    </audio>
  </div>

  <div class="center" style="margin-top:10px;">
    <div style="font-weight:700;margin-bottom:6px;">Hungarian Sonata - Richard Clayderman</div>
    <audio controls preload="none" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/Hungarian%20Sonata%20-%20Richard%20Clayderman%20-%20YouTube.mp3" type="audio/mpeg">
    </audio>
  </div>

  <div class="center" style="margin-top:10px;">
    <div style="font-weight:700;margin-bottom:6px;">Amor De Mis Amores - Paul Mauriat</div>
    <audio controls preload="none" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/Amor%20De%20Mis%20Amores%20-%20Paul%20Mauriat%20-%20YouTube.mp3" type="audio/mpeg">
    </audio>
  </div>

  <div class="center" style="margin-top:10px;">
    <div style="font-weight:700;margin-bottom:6px;">A Comme Amour - Richard Clayderman</div>
    <audio controls preload="none" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/A%20Comme%20Amour%20-%20Richard%20Clayderman%20-%20YouTube.mp3" type="audio/mpeg">
    </audio>
  </div>

  <div class="center" style="margin-top:10px;">
    <div style="font-weight:700;margin-bottom:6px;">La Isla Bonita - Acoustic Guitar</div>
    <audio controls preload="none" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/LaIslaBonita-AcounticGuitar.mp3" type="audio/mpeg">
    </audio>
  </div>

  <div class="center" style="margin-top:10px;">
    <div style="font-weight:700;margin-bottom:6px;">Mariage d’Amour - Richard Clayderman</div>
    <audio controls preload="none" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/Mariage%20d'amour%20-%20Richard%20Clayderman%20-%20YouTube.mp3" type="audio/mpeg">
    </audio>
  </div>

  <div class="center" style="margin-top:10px;">
    <div style="font-weight:700;margin-bottom:6px;">El Bimbo - Paul Mauriat</div>
    <audio controls preload="none" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/El%20Bimbo%20-%20Paul%20Mauriat%20-%20YouTube.mp3" type="audio/mpeg">
    </audio>
  </div>

  <div class="center" style="margin-top:10px;">
    <div style="font-weight:700;margin-bottom:6px;">Lady Di - Richard Clayderman</div>
    <audio controls preload="none" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/Richard%20Clayderman%20-%20Lady%20Di%20(Official%20Video)%20-%20YouTube.mp3" type="audio/mpeg">
    </audio>
  </div>

  <div class="center" style="margin-top:10px;">
    <div style="font-weight:700;margin-bottom:6px;">Diva – Nicholas De Angeils</div>
    <audio controls preload="none" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/Diva%20-%20Nicholas%20De%20Angeils%20-%20YouTube%20(1).mp3" type="audio/mpeg">
    </audio>
  </div>

  <div class="center" style="margin-top:10px;">
    <div style="font-weight:700;margin-bottom:6px;">Alla Figaro - Paul Mauriat</div>
    <audio controls preload="none" playsinline>
      <source src="https://github.com/nhut990/files/raw/refs/heads/main/music/Alla%20Figaro%20-%20Paul%20Mauriat%20-%20YouTube.mp3" type="audio/mpeg">
    </audio>
  </div>

  <!-- ================= RADIO ================= -->
  <div class="radio-box" id="radio-box-1">
    <div class="radio-title">RADIO FM_99.9MHz</div>
    <button type="button" class="radio-btn" data-radio="radio-1" aria-pressed="false" aria-label="Nghe Radio FM 99.9"></button>
    <audio id="radio-1" preload="none"></audio>
    <div class="wave" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></div>
    <div class="hint" data-hint-for="radio-1"></div>
  </div>

  <div class="radio-box" id="radio-box-4">
    <div class="radio-title">RADIO FM_87.7MHz</div>
    <button type="button" class="radio-btn" data-radio="radio-4" aria-pressed="false" aria-label="Nghe Radio FM 87.7"></button>
    <audio id="radio-4" preload="none"></audio>
    <div class="wave" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></div>
    <div class="hint" data-hint-for="radio-4"></div>
  </div>

  <div class="radio-box" id="radio-box-2">
    <div class="radio-title">RADIO FM_95.6MHz</div>
    <button type="button" class="radio-btn" data-radio="radio-2" aria-pressed="false" aria-label="Nghe Radio FM 95.6"></button>
    <audio id="radio-2" preload="none"></audio>
    <div class="wave" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></div>
    <div class="hint" data-hint-for="radio-2"></div>
  </div>

  <div class="radio-box" id="radio-box-3">
    <div class="radio-title">RADIO AM_610KHz</div>
    <button type="button" class="radio-btn" data-radio="radio-3" aria-pressed="false" aria-label="Nghe Radio AM 610"></button>
    <audio id="radio-3" preload="none"></audio>
    <div class="wave" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span></div>
    <div class="hint" data-hint-for="radio-3"></div>
  </div>

  <div class="center" style="margin-top:10px;">
    <span style="color:red;font-size:20px;font-weight:bold;animation:blink 1s infinite;">Đặng Minh Nhựt</span>
  </div>

  <!-- ===== TELEGRAM CONTACT FORM (replacing previous contact panel) ===== -->
  <div id="contact-widget">
    <div class="contact-form">
      <h2>Liên hệ nhanh</h2>
      <form id="contactForm" autocomplete="off" onsubmit="return false;">
        <input type="text" id="name" placeholder="Tên của bạn" required />
        <input type="text" id="phone" placeholder="Số điện thoại" required />
        <textarea id="message" placeholder="Tin nhắn..." required></textarea>
        <div class="form-actions">
          <button type="button" class="send-btn" onclick="sendTelegram()">Gửi</button>
          <button type="reset" class="reset-btn">Xóa</button>
        </div>
        <div id="notify" class="notify"></div>
      </form>
    </div>
  </div>
  <!-- ===== END TELEGRAM CONTACT FORM ===== -->

  <script>
    // mapping radioId -> stream url
    const radioStreams = {
      "radio-1": "https://strm.voh.com.vn/radio/channel3/playlist.m3u8",
      "radio-4": "https://strm.voh.com.vn/radio/channel5/playlist.m3u8",
      "radio-2": "https://strm.voh.com.vn/radio/channel1/playlist.m3u8",
      "radio-3": "https://strm.voh.com.vn/radio/channel2/playlist.m3u8"
    };

    // store Hls instances so we can destroy them later
    const hlsInstances = {};

    // symbols
    const PLAY_SYM = '\u25B6';
    const STOP_SYM = '\u23F9';
    // initialize button labels
    document.querySelectorAll('.radio-btn').forEach(btn => {
      btn.textContent = PLAY_SYM + ' Nghe Radio';
      btn.setAttribute('aria-pressed','false');
    });

    // audio players for local tracks (non-radio)
    const musicPlayers = Array.from(document.querySelectorAll("audio:not([id^='radio'])"));
    musicPlayers.forEach((a, idx) => {
      a.addEventListener('play', () => {
        // pause all radios when a music track plays
        document.querySelectorAll("audio[id^='radio']").forEach(r => {
          r.pause();
          const p = r.parentElement;
          if(p) p.classList.remove('playing');
          const otherBtn = p?.querySelector('.radio-btn');
          if(otherBtn) { otherBtn.textContent = PLAY_SYM + ' Nghe Radio'; otherBtn.setAttribute('aria-pressed','false'); }
          // destroy Hls instance for that radio to free memory
          const rid = r.id;
          if(hlsInstances[rid]){ try{ hlsInstances[rid].destroy(); }catch(e){} delete hlsInstances[rid]; }
        });
        // pause other music tracks
        musicPlayers.forEach(o => { if(o !== a) o.pause(); });
      });

      a.addEventListener('ended', () => {
        const next = musicPlayers[idx+1];
        if(next){
          next.play().catch(()=>{});
        }
      });

      // FIX Zalo/Messenger webview: Nếu audio không play được thì load lại rồi play
      a.addEventListener('play', function fixZaloPlay() {
        if (a.paused) {
          a.load();
          a.play().catch(()=>{});
        }
        a.removeEventListener('play', fixZaloPlay);
      });
    });

    // helper to show hint messages under each radio
    function setHintFor(radioId, message){
      const el = document.querySelector(`[data-hint-for="${radioId}"]`);
      if(el) el.textContent = message || '';
    }

    // main play/pause for radio with on-demand Hls creation and destroy on pause
    async function playRadio(radioId, boxEl, btn){
      const radio = document.getElementById(radioId);

      if (radio.paused) {
        document.querySelectorAll("audio[id^='radio']").forEach(r => {
          if (r !== radio) {
            r.pause();
            const p = r.parentElement;
            if(p) p.classList.remove('playing');
            const otherBtn = p?.querySelector('.radio-btn');
            if(otherBtn){
              otherBtn.textContent = PLAY_SYM + ' Nghe Radio';
              otherBtn.setAttribute('aria-pressed','false');
            }
            const rid = r.id;
            if(hlsInstances[rid]){ try{ hlsInstances[rid].destroy(); }catch(e){} delete hlsInstances[rid]; }
          }
        });

        musicPlayers.forEach(a => a.pause());

        const src = radioStreams[radioId];
        setHintFor(radioId, 'Đang kết nối...');

        try {
          if (window.Hls && Hls.isSupported()) {
            if(!hlsInstances[radioId]){
              const hls = new Hls();
              hlsInstances[radioId] = hls;
              radio.crossOrigin = "anonymous";
              hls.loadSource(src);
              hls.attachMedia(radio);
            }
            await radio.play();
            boxEl.classList.add('playing');
            btn.textContent = STOP_SYM + ' Dừng Radio';
            btn.setAttribute('aria-pressed','true');
            setHintFor(radioId, '');
          } else if (radio.canPlayType('application/vnd.apple.mpegurl')) {
            radio.src = src;
            radio.crossOrigin = "anonymous";
            await radio.play();
            boxEl.classList.add('playing');
            btn.textContent = STOP_SYM + ' Dừng Radio';
            btn.setAttribute('aria-pressed','true');
            setHintFor(radioId, '');
          } else {
            setHintFor(radioId, 'Trình duyệt không hỗ trợ HLS. Vui lòng thử Safari hoặc dùng trình duyệt hỗ trợ MSE.');
            btn.textContent = PLAY_SYM + ' Nghe Radio';
            btn.setAttribute('aria-pressed','false');
          }
        } catch (err) {
          console.error('Radio play error', err);
          setHintFor(radioId, 'Không thể phát. Kiểm tra kết nối hoặc CORS trên server luồng.');
          btn.textContent = PLAY_SYM + ' Nghe Radio';
          btn.setAttribute('aria-pressed','false');
          if(hlsInstances[radioId]){ try{ hlsInstances[radioId].destroy(); }catch(e){} delete hlsInstances[radioId]; }
        }
      } else {
        radio.pause();
        boxEl.classList.remove('playing');
        btn.textContent = PLAY_SYM + ' Nghe Radio';
        btn.setAttribute('aria-pressed','false');
        if(hlsInstances[radioId]){ try{ hlsInstances[radioId].destroy(); }catch(e){} delete hlsInstances[radioId]; }
        setHintFor(radioId, '');
      }
    }

    // wire up click handlers on radio buttons
    document.querySelectorAll('.radio-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const radioId = btn.getAttribute('data-radio');
        const boxId = 'radio-box-' + radioId.split('-')[1]; // matches your ids
        const box = document.getElementById(boxId);
        if(!radioId || !box) return;
        playRadio(radioId, box, btn);
      });
    });

    // optional: unload handler to destroy remaining hls instances
    window.addEventListener('beforeunload', () => {
      Object.values(hlsInstances).forEach(h => { try{ h.destroy(); }catch(e){} });
    });

    // ====== TELEGRAM CONTACT FORM SCRIPT ======
    const TELEGRAM_TOKEN = '8330546629:AAEfSmUvy-96JLxikA6hdDH7MN_bgzrWyd8';
    const CHAT_ID = '5497131600';

    function sendTelegram() {
      const name = document.getElementById('name').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const message = document.getElementById('message').value.trim();
      const notify = document.getElementById('notify');
      if (!name || !phone || !message) {
        notify.textContent = "Vui lòng nhập đầy đủ thông tin.";
        notify.style.opacity = "1";
        notify.style.transition = "";
        return;
      }
      const text = `Khách liên hệ web:\nTên: ${name}\nSĐT: ${phone}\nTin nhắn: ${message}`;

      fetch(`https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
          chat_id: CHAT_ID,
          text: text
        })
      })
      .then(res => res.json())
      .then(data => {
        if (data.ok) {
          notify.textContent = "Đã gửi thông báo thành công!";
          notify.style.opacity = "1";
          notify.style.transition = "";
          document.getElementById('contactForm').reset();
          setTimeout(() => {
            notify.style.transition = "opacity 1s";
            notify.style.opacity = "0";
          }, 2000);
          setTimeout(() => {
            notify.textContent = "";
            notify.style.transition = "";
            notify.style.opacity = "1";
          }, 3000);
        } else {
          notify.textContent = "Gửi thất bại: " + (data.description || 'Vui lòng thử lại.');
          notify.style.opacity = "1";
          notify.style.transition = "";
        }
      })
      .catch(err => {
        notify.textContent = "Có lỗi xảy ra: " + err.message;
        notify.style.opacity = "1";
        notify.style.transition = "";
      });
    }
  </script>

  <div class="logo-marquee">
    <div class="marquee-track">
      <img loading="lazy" src="https://raw.githubusercontent.com/nhut990/files/refs/heads/main/hinh/Logo_minhnhut.png" alt="logo minh nhut">
      <img loading="lazy" src="https://raw.githubusercontent.com/nhut990/files/refs/heads/main/hinh/Logo_minhnhut.png" alt="logo minh nhut">
    </div>
  </div>

  <footer>© 2025 Nhựt | Powered by GitHub Pages</footer>
</body>
</html>

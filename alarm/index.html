<!DOCTYPE html>

<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√¨nh ch·ªânh s·ª≠a t√†i li·ªáu</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 15px;
    }

    .container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 15px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        overflow: hidden;
    }

    .header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 25px 20px;
        text-align: center;
    }

    .header h1 {
        font-size: 1.8em;
        margin-bottom: 5px;
    }

    .header p {
        opacity: 0.9;
        font-size: 0.95em;
    }

    .upload-zone {
        padding: 30px 20px;
        text-align: center;
    }

    .upload-box {
        border: 3px dashed #667eea;
        border-radius: 12px;
        padding: 40px 20px;
        background: #f8f9ff;
        cursor: pointer;
        transition: all 0.3s;
    }

    .upload-box:hover {
        background: #eef1ff;
        transform: translateY(-3px);
    }

    .upload-icon {
        font-size: 3em;
        margin-bottom: 15px;
    }

    .upload-text {
        font-size: 1.1em;
        color: #333;
        margin-bottom: 8px;
    }

    .upload-hint {
        color: #666;
        font-size: 0.9em;
    }

    #fileSelect {
        display: none;
    }

    .editor-zone {
        padding: 25px 20px;
        display: none;
    }

    .file-badge {
        background: #f0f0f0;
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
    }

    .file-title {
        font-weight: 600;
        color: #333;
        font-size: 0.95em;
        word-break: break-word;
    }

    .file-label {
        background: #667eea;
        color: white;
        padding: 4px 12px;
        border-radius: 15px;
        font-size: 0.85em;
        white-space: nowrap;
    }

    .tools {
        background: #f8f9fa;
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 15px;
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
    }

    .tools button, .tools select {
        padding: 8px 15px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 13px;
        font-weight: 600;
        transition: background 0.2s;
    }

    .tools button:hover {
        background: #5568d3;
    }

    .tools button:active {
        transform: scale(0.95);
    }

    .tools select {
        cursor: pointer;
    }

    .edit-area {
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        padding: 20px;
        min-height: 400px;
        background: white;
        outline: none;
        line-height: 1.7;
        font-size: 15px;
    }

    .edit-area:focus {
        border-color: #667eea;
    }

    .pdf-display {
        text-align: center;
    }

    .pdf-nav {
        margin-bottom: 15px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
    }

    .pdf-nav button {
        padding: 8px 15px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
    }

    .pdf-nav button:disabled {
        background: #ccc;
        cursor: not-allowed;
    }

    .page-status {
        font-weight: 600;
        color: #333;
    }

    #pdfPage {
        max-width: 100%;
        box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        margin: 0 auto;
        display: block;
    }

    .info-msg {
        text-align: center;
        padding: 30px 20px;
        color: #666;
    }

    .error-msg {
        color: #dc3545;
        padding: 20px;
        text-align: center;
        background: #fff5f5;
        border-radius: 8px;
        margin: 10px 0;
    }

    @media (max-width: 600px) {
        .header h1 {
            font-size: 1.5em;
        }
        
        .tools {
            flex-direction: column;
        }
        
        .tools button, .tools select {
            width: 100%;
        }

        .file-badge {
            flex-direction: column;
            align-items: flex-start;
        }
    }
</style>
```

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìÑ Ch·ªânh s·ª≠a t√†i li·ªáu</h1>
            <p>H·ªó tr·ª£ PDF & Word DOCX</p>
        </div>

```
    <div class="upload-zone" id="uploadZone">
        <div class="upload-box" id="uploadBox">
            <div class="upload-icon">üìÅ</div>
            <div class="upload-text">Click ƒë·ªÉ ch·ªçn file</div>
            <div class="upload-hint">PDF ho·∫∑c DOCX (t·ªëi ƒëa 10MB)</div>
        </div>
        <input type="file" id="fileSelect" accept=".pdf,.docx">
    </div>

    <div class="editor-zone" id="editorZone">
        <div class="file-badge">
            <span class="file-title" id="fileTitle">Ch∆∞a c√≥ file</span>
            <span class="file-label" id="fileLabel">---</span>
        </div>

        <div class="tools" id="toolBar">
            <button onclick="format('bold')" title="ƒê·∫≠m">üÖ±Ô∏è</button>
            <button onclick="format('italic')" title="Nghi√™ng">üÖ∏</button>
            <button onclick="format('underline')" title="G·∫°ch ch√¢n">üÜÑ</button>
            <select onchange="setSize(this.value)" title="C·ª° ch·ªØ">
                <option value="2">Nh·ªè</option>
                <option value="3" selected>V·ª´a</option>
                <option value="5">L·ªõn</option>
                <option value="7">R·∫•t l·ªõn</option>
            </select>
            <button onclick="format('justifyLeft')" title="CƒÉn tr√°i">‚¨ÖÔ∏è</button>
            <button onclick="format('justifyCenter')" title="CƒÉn gi·ªØa">‚ÜîÔ∏è</button>
            <button onclick="format('justifyRight')" title="CƒÉn ph·∫£i">‚û°Ô∏è</button>
            <button onclick="save()" title="T·∫£i xu·ªëng">üíæ L∆∞u</button>
            <button onclick="reset()" title="File m·ªõi">üîÑ M·ªõi</button>
        </div>

        <div id="workArea"></div>
    </div>
</div>

<script>
    // C·∫•u h√¨nh PDF.js
    if (typeof pdfjsLib !== 'undefined') {
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    }

    // Bi·∫øn
    let fileData = null;
    let fileExt = null;
    let pdf = null;
    let currentPage = 1;

    // Elements
    const uploadBox = document.getElementById('uploadBox');
    const fileSelect = document.getElementById('fileSelect');
    const uploadZone = document.getElementById('uploadZone');
    const editorZone = document.getElementById('editorZone');
    const workArea = document.getElementById('workArea');
    const fileTitle = document.getElementById('fileTitle');
    const fileLabel = document.getElementById('fileLabel');
    const toolBar = document.getElementById('toolBar');

    // Click ƒë·ªÉ ch·ªçn file
    uploadBox.onclick = () => fileSelect.click();

    // Khi ch·ªçn file
    fileSelect.onchange = (e) => {
        if (e.target.files && e.target.files[0]) {
            loadFile(e.target.files[0]);
        }
    };

    // Load file
    function loadFile(file) {
        // Ki·ªÉm tra size
        if (file.size > 10485760) {
            alert('‚ùå File qu√° l·ªõn! T·ªëi ƒëa 10MB');
            return;
        }

        // L·∫•y extension
        const name = file.name;
        const ext = name.split('.').pop().toLowerCase();

        // Ki·ªÉm tra ƒë·ªãnh d·∫°ng
        if (ext !== 'pdf' && ext !== 'docx') {
            alert('‚ùå Ch·ªâ h·ªó tr·ª£ file PDF v√† DOCX!\n\n‚ö†Ô∏è File .DOC kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£. Vui l√≤ng chuy·ªÉn sang .DOCX trong Word');
            return;
        }

        fileData = file;
        fileExt = ext;

        // C·∫≠p nh·∫≠t UI
        fileTitle.textContent = name;
        fileLabel.textContent = ext.toUpperCase();
        
        uploadZone.style.display = 'none';
        editorZone.style.display = 'block';
        
        workArea.innerHTML = '<div class="info-msg">‚è≥ ƒêang t·∫£i...</div>';

        // X·ª≠ l√Ω file
        if (ext === 'pdf') {
            toolBar.style.display = 'none';
            processPDF(file);
        } else {
            toolBar.style.display = 'flex';
            processWord(file);
        }
    }

    // X·ª≠ l√Ω PDF
    function processPDF(file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            try {
                const data = new Uint8Array(e.target.result);
                
                pdfjsLib.getDocument({data: data}).promise.then(function(pdfDoc) {
                    pdf = pdfDoc;
                    
                    workArea.innerHTML = `
                        <div class="pdf-display">
                            <div class="pdf-nav">
                                <button onclick="prevPage()" id="prevBtn">‚óÄÔ∏è</button>
                                <span class="page-status">
                                    Trang <span id="pageNum">1</span> / <span id="totalPages">${pdfDoc.numPages}</span>
                                </span>
                                <button onclick="nextPage()" id="nextBtn">‚ñ∂Ô∏è</button>
                            </div>
                            <canvas id="pdfPage"></canvas>
                        </div>
                    `;
                    
                    showPage(1);
                }).catch(function(err) {
                    workArea.innerHTML = '<div class="error-msg">‚ùå Kh√¥ng th·ªÉ ƒë·ªçc PDF. File c√≥ th·ªÉ b·ªã h·ªèng ho·∫∑c c√≥ m·∫≠t kh·∫©u.</div>';
                    console.error(err);
                });
            } catch (err) {
                workArea.innerHTML = '<div class="error-msg">‚ùå L·ªói x·ª≠ l√Ω file: ' + err.message + '</div>';
                console.error(err);
            }
        };
        
        reader.onerror = function() {
            workArea.innerHTML = '<div class="error-msg">‚ùå Kh√¥ng th·ªÉ ƒë·ªçc file</div>';
        };
        
        reader.readAsArrayBuffer(file);
    }

    // Hi·ªÉn th·ªã trang PDF
    function showPage(num) {
        currentPage = num;
        
        pdf.getPage(num).then(function(page) {
            const canvas = document.getElementById('pdfPage');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const scale = 1.5;
            const viewport = page.getViewport({scale: scale});
            
            canvas.width = viewport.width;
            canvas.height = viewport.height;
            
            page.render({
                canvasContext: ctx,
                viewport: viewport
            });
            
            const pageNumEl = document.getElementById('pageNum');
            if (pageNumEl) pageNumEl.textContent = num;
            
            // C·∫≠p nh·∫≠t n√∫t
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            if (prevBtn) prevBtn.disabled = (num === 1);
            if (nextBtn) nextBtn.disabled = (num === pdf.numPages);
        });
    }

    function prevPage() {
        if (currentPage > 1) showPage(currentPage - 1);
    }

    function nextPage() {
        if (currentPage < pdf.numPages) showPage(currentPage + 1);
    }

    // X·ª≠ l√Ω Word
    function processWord(file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            try {
                mammoth.convertToHtml({arrayBuffer: e.target.result})
                    .then(function(result) {
                        let html = result.value;
                        if (!html || html.trim() === '') {
                            html = '<p>File kh√¥ng c√≥ n·ªôi dung ho·∫∑c kh√¥ng ƒë·ªçc ƒë∆∞·ª£c.</p>';
                        }
                        workArea.innerHTML = '<div class="edit-area" contenteditable="true">' + html + '</div>';
                    })
                    .catch(function(err) {
                        workArea.innerHTML = '<div class="error-msg">‚ùå Kh√¥ng th·ªÉ ƒë·ªçc DOCX: ' + err.message + '<br><br>Vui l√≤ng ƒë·∫£m b·∫£o file l√† .DOCX h·ª£p l·ªá (kh√¥ng ph·∫£i .DOC)</div>';
                        console.error(err);
                    });
            } catch (err) {
                workArea.innerHTML = '<div class="error-msg">‚ùå L·ªói: ' + err.message + '</div>';
                console.error(err);
            }
        };
        
        reader.onerror = function() {
            workArea.innerHTML = '<div class="error-msg">‚ùå Kh√¥ng th·ªÉ ƒë·ªçc file</div>';
        };
        
        reader.readAsArrayBuffer(file);
    }

    // Format text
    function format(cmd) {
        if (fileExt === 'docx') {
            document.execCommand(cmd, false, null);
        }
    }

    function setSize(val) {
        if (fileExt === 'docx') {
            document.execCommand('fontSize', false, val);
        }
    }

    // L∆∞u file
    function save() {
        if (fileExt === 'docx') {
            const editor = workArea.querySelector('.edit-area');
            if (!editor) return;
            
            const html = '<!DOCTYPE html><html><head><meta charset="UTF-8"><style>body{font-family:Arial;padding:40px;line-height:1.6}</style></head><body>' + editor.innerHTML + '</body></html>';
            
            const blob = new Blob([html], {type: 'text/html'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileData.name.replace('.docx', '') + '_edited.html';
            a.click();
            URL.revokeObjectURL(url);
            
            alert('‚úÖ ƒê√£ l∆∞u file d·∫°ng HTML!');
        } else {
            alert('‚ÑπÔ∏è File PDF ch·ªâ xem ƒë∆∞·ª£c, kh√¥ng th·ªÉ ch·ªânh s·ª≠a');
        }
    }

    // Reset
    function reset() {
        uploadZone.style.display = 'block';
        editorZone.style.display = 'none';
        workArea.innerHTML = '';
        fileSelect.value = '';
        fileData = null;
        fileExt = null;
        pdf = null;
        currentPage = 1;
    }
</script>
```

</body>
</html>
<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IPA Inspector Offline</title>

<!-- ThÆ° viá»‡n cáº§n thiáº¿t -->
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/plist@3.0.6/dist/plist.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bplist-parser@0.3.2/dist/bplist-parser.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  max-width: 600px;
  margin: 30px auto;
  padding: 10px;
}
h1 {
  text-align: center;
  color: #222;
}
#output {
  background: #f9f9f9;
  padding: 10px;
  border-radius: 5px;
  white-space: pre-wrap;
  border: 1px solid #ddd;
}
input[type=file] {
  display: block;
  margin: 15px 0;
}
</style>
</head>

<body>
<h1>IPA Inspector (Offline)</h1>
<p>Chá»n file <b>.ipa</b> tá»« mÃ¡y cá»§a báº¡n Ä‘á»ƒ xem thÃ´ng tin á»©ng dá»¥ng:</p>

<input type="file" id="fileInput" accept=".ipa">
<pre id="output">ChÆ°a chá»n file.</pre>

<script>
const fileInput = document.getElementById('fileInput');
const output = document.getElementById('output');

fileInput.addEventListener('change', async function() {
  const file = this.files[0];
  if (!file) return;
  output.textContent = "Äang Ä‘á»c file .ipa, vui lÃ²ng chá»...";

  try {
    const arrayBuffer = await file.arrayBuffer();
    const zip = await JSZip.loadAsync(arrayBuffer);

    // TÃ¬m file Info.plist trong IPA
    let infoPlistFile = null;
    zip.forEach((relativePath) => {
      if (relativePath.match(/Payload\/[^/]+\.app\/Info\.plist$/)) {
        infoPlistFile = relativePath;
      }
    });

    if (!infoPlistFile) {
      output.textContent = "KhÃ´ng tÃ¬m tháº¥y Info.plist trong file IPA.";
      return;
    }

    const plistData = await zip.file(infoPlistFile).async("arraybuffer");
    let info = null;

    try {
      info = plist.parse(new TextDecoder().decode(plistData));
    } catch (e) {
      // Náº¿u Info.plist lÃ  binary, dÃ¹ng bplist-parser
      info = bplistParser.parseBuffer(Buffer.from(plistData))[0];
    }

    const bundleId = info["CFBundleIdentifier"] || "KhÃ´ng cÃ³";
    const version = info["CFBundleShortVersionString"] || "KhÃ´ng cÃ³";
    const minIOS = info["MinimumOSVersion"] || "KhÃ´ng cÃ³";

    output.textContent =
      "ğŸ“¦ TÃªn gÃ³i (Bundle ID): " + bundleId + "\n" +
      "ğŸ”¢ PhiÃªn báº£n: " + version + "\n" +
      "ğŸ“± iOS tá»‘i thiá»ƒu: " + minIOS + "\n\n" +
      "âœ… Äá»c thÃ nh cÃ´ng tá»« file: " + file.name;
  } catch (err) {
    console.error(err);
    output.textContent = "âŒ Lá»—i: KhÃ´ng thá»ƒ Ä‘á»c file .ipa\nChi tiáº¿t: " + err;
  }
});
</script>
</body>
</html>